import requests
from bs4 import BeautifulSoup

url_first = "https://www.cpsbc.ca/public/registrant-directory/search-result"
url_second = "https://www.cpsbc.ca/public/registrant-directory?ajax_form=1&_wrapper_format=drupal_ajax"

response = requests.get(url_first)

if response.status_code == 200:

    soup = BeautifulSoup(response.text, "html.parser")

    form_build_id = soup.find("input", {"name": "form_build_id"})["value"]
    
    payload = {
        "form_build_id": form_build_id,
        "form_id": "cpsbc_directory_form",
        "ps_advance_search": "show",
        "ps_last_name": "Anu",
        "ps_first_name": "Aalto",
        "msp_number": "",
        "_triggering_element_name": "op",
        "_triggering_element_value": "Search",
        "_drupal_ajax": "1",
    }

    response = requests.post(url_second, data=payload)

    if response.status_code == 200:
        print(response.text)
    else:
        print("Error:", response.status_code)
else:
    print("Error:", response.status_code)


